<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrustMyMsg ‚Äî Verify Any Message With AI</title>
    <meta name="description" content="AI-powered scam detection tool. Upload a screenshot and get instant risk analysis for romance scams, crypto fraud, and phishing attempts.">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }

        html {
            scroll-behavior: smooth;
        }

        .gradient-hero {
            background: linear-gradient(135deg, #0F172A 0%, #1E293B 50%, #0F172A 100%);
        }

        .glow-green {
            box-shadow: 0 0 30px rgba(16, 185, 129, 0.6);
        }

        .glow-blue {
            box-shadow: 0 0 25px rgba(37, 99, 235, 0.5);
        }

        .glow-red {
            box-shadow: 0 0 25px rgba(239, 68, 68, 0.5);
        }

        .glow-yellow {
            box-shadow: 0 0 25px rgba(245, 158, 11, 0.5);
        }

        @keyframes pulse-border {
            0%, 100% { border-color: rgba(59, 130, 246, 0.6); }
            50% { border-color: rgba(16, 185, 129, 0.8); }
        }

        .pulse-border {
            animation: pulse-border 3s ease-in-out infinite;
        }

        @keyframes scale-in {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }

        .scale-in {
            animation: scale-in 0.5s ease-out forwards;
        }

        .spinner {
            border: 3px solid rgba(16, 185, 129, 0.3);
            border-top-color: #10B981;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .cyber-panel {
            background: #1E293B;
            border: 1px solid rgba(59, 130, 246, 0.2);
            transition: all 0.3s ease;
        }

        .cyber-panel:hover {
            border-color: #10B981;
            box-shadow: 0 8px 16px rgba(16, 185, 129, 0.2);
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-100">

    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 bg-slate-900/85 backdrop-blur-lg border-b border-blue-500/20">
        <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <svg class="w-7 h-7 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                </svg>
                <span class="text-2xl font-bold text-slate-100">TrustMyMsg</span>
            </div>
            <div class="hidden md:flex items-center gap-6 text-sm">
                <a href="#scanner" class="text-slate-400 hover:text-green-500 transition">Scan Message</a>
                <a href="#mission" class="text-slate-400 hover:text-green-500 transition">Mission</a>
                <a href="#support" class="text-slate-400 hover:text-green-500 transition">Support</a>
                <a href="#faq" class="text-slate-400 hover:text-green-500 transition">FAQ</a>
            </div>
            <a href="#support" class="bg-green-500 text-slate-900 px-6 py-2 rounded-lg font-semibold hover:bg-green-400 transition">
                Support Us
            </a>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="gradient-hero min-h-screen flex items-center justify-center text-center px-6 pt-24 pb-16">
        <div class="max-w-4xl">
            <div class="flex justify-center mb-8">
                <div class="relative">
                    <svg class="w-24 h-24 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                    </svg>
                    <div class="absolute inset-0 glow-green rounded-full"></div>
                </div>
            </div>
            <h1 class="text-5xl md:text-7xl font-black mb-6 leading-tight">
                Verify Any Message With AI
            </h1>
            <p class="text-xl md:text-2xl text-slate-300 mb-10 max-w-2xl mx-auto">
                Not sure if someone's real or a scam? Upload your chat ‚Äî get instant clarity.
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="#scanner" class="bg-green-500 text-slate-900 px-8 py-4 rounded-lg font-bold text-lg hover:bg-green-400 glow-green transition flex items-center justify-center gap-2">
                    <span>üõ°Ô∏è</span> Scan a Message
                </a>
                <a href="#support" class="border-2 border-green-500 text-green-500 px-8 py-4 rounded-lg font-bold text-lg hover:bg-green-500/10 transition flex items-center justify-center gap-2">
                    <span>üíö</span> Support the Mission
                </a>
            </div>
        </div>
    </section>

    <!-- Scanner Section -->
    <section id="scanner" class="py-20 px-6 bg-slate-800">
        <div class="max-w-4xl mx-auto">
            <div class="text-center mb-12">
                <h2 class="text-4xl md:text-5xl font-bold mb-4">Upload a Screenshot ‚Äî Get Instant Risk Score</h2>
                <p class="text-xl text-slate-400 mb-6">Detects romance scams, crypto fraud, fake emergencies and more.</p>
                <p class="text-sm text-green-500 italic">üîí Your image is analyzed securely. We never store or share uploads.</p>
            </div>

            <!-- Upload Area -->
            <div id="uploadArea" class="border-2 border-dashed border-blue-500/60 rounded-xl p-10 text-center bg-slate-900/50 pulse-border cursor-pointer hover:border-green-500 transition">
                <input type="file" id="fileInput" accept="image/*" class="hidden">
                <div id="uploadPrompt">
                    <svg class="w-16 h-16 mx-auto mb-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                    </svg>
                    <p class="text-xl font-semibold mb-2">Drop your screenshot here</p>
                    <p class="text-slate-400 mb-4">or click to browse</p>
                    <button onclick="document.getElementById('fileInput').click()" class="bg-green-500 text-slate-900 px-6 py-3 rounded-lg font-semibold hover:bg-green-400 transition">
                        Select Image
                    </button>
                </div>
                <div id="previewArea" class="hidden">
                    <img id="previewImage" class="max-h-64 mx-auto rounded-lg mb-4 border-2 border-green-500">
                    <div class="flex gap-4 justify-center">
                        <button id="analyzeBtn" class="bg-green-500 text-slate-900 px-8 py-3 rounded-lg font-bold hover:bg-green-400 transition">
                            Analyze Message
                        </button>
                        <button id="clearBtn" class="border-2 border-green-500 text-green-500 px-8 py-3 rounded-lg font-semibold hover:bg-green-500/10 transition">
                            Clear
                        </button>
                    </div>
                </div>
            </div>

            <!-- Loading State -->
            <div id="loadingState" class="hidden text-center mt-8">
                <div class="spinner mx-auto mb-4"></div>
                <p class="text-lg text-slate-300">Analyzing your screenshot...</p>
            </div>

            <!-- Error State -->
            <div id="errorState" class="hidden mt-8 cyber-panel border-red-500 bg-red-500/10 p-6 rounded-xl">
                <div class="flex items-start gap-3">
                    <svg class="w-6 h-6 text-red-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                    <p id="errorMessage" class="text-red-400"></p>
                </div>
            </div>

            <!-- Results Area -->
            <div id="resultsArea" class="hidden mt-12 space-y-6">
                <!-- Risk Score Card -->
                <div id="riskCard" class="cyber-panel rounded-xl p-8 text-center scale-in">
                    <svg id="riskIcon" class="w-20 h-20 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div id="riskScore" class="text-8xl font-black mb-3">0</div>
                    <div id="riskLevel" class="text-4xl font-bold mb-2">SAFE</div>
                    <p class="text-slate-400">Risk Score (0-100)</p>
                </div>

                <!-- Red Flags -->
                <div class="cyber-panel rounded-xl p-6">
                    <h3 class="text-2xl font-bold mb-4 flex items-center gap-2">
                        <svg class="w-6 h-6 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                        </svg>
                        Detected Red Flags
                    </h3>
                    <div id="redFlagsList"></div>
                </div>

                <!-- Analysis -->
                <div id="analysisCard" class="cyber-panel rounded-xl p-6">
                    <h3 class="text-2xl font-bold mb-4">Analysis</h3>
                    <p id="explanationText" class="text-lg text-slate-300 mb-6 leading-relaxed"></p>
                    <div class="pt-6 border-t border-blue-500/20">
                        <h4 id="recommendationTitle" class="text-xl font-semibold mb-3 text-green-500">Recommendation:</h4>
                        <p id="recommendationText" class="text-lg text-slate-300 leading-relaxed"></p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Mission Section -->
    <section id="mission" class="py-24 px-6 bg-slate-900">
        <div class="max-w-5xl mx-auto">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-bold mb-6">Why We Exist</h2>
                <p class="text-xl text-slate-300 max-w-3xl mx-auto leading-relaxed">
                    Every day, thousands are manipulated by fake relationships, urgent pleas and fraudulent messages. 
                    TrustMyMsg gives anyone the power to verify chats before it's too late.
                </p>
            </div>

            <!-- Founder Quote -->
            <div class="cyber-panel max-w-3xl mx-auto rounded-xl p-8 border-l-4 border-green-500">
                <div class="flex flex-col md:flex-row gap-6 items-center">
                    <div class="w-28 h-28 rounded-full bg-green-500/10 border-2 border-green-500 flex items-center justify-center flex-shrink-0">
                        <svg class="w-14 h-14 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                    </div>
                    <div class="flex-1 text-center md:text-left">
                        <p class="text-xl italic text-slate-200 mb-4 leading-relaxed">
                            "Too many people have lost money, dignity, and trust to scammers. TrustMyMsg is my way of fighting back."
                        </p>
                        <p class="text-green-500 font-semibold">‚Äî C.H., Founder</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Support Section -->
    <section id="support" class="py-20 px-6 bg-slate-800">
        <div class="max-w-4xl mx-auto text-center">
            <svg class="w-12 h-12 mx-auto mb-6 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
            </svg>
            <h2 class="text-4xl md:text-5xl font-bold mb-4">Support the Mission</h2>
            <p class="text-xl text-slate-300 mb-2">
                We rely on people like you to spread awareness and stop scammers.
            </p>
            <p class="text-slate-400 italic mb-12">Small donations help us protect more people.</p>

            <!-- Donation Tiers -->
            <div class="flex flex-col sm:flex-row gap-5 justify-center mb-12">
                <a href="https://buy.stripe.com/test_5kA7uZ7dZ7Ahdbi4gg" target="_blank" rel="noopener" class="cyber-panel rounded-xl p-6 border-2 border-green-500 hover:bg-green-500/10 transition flex flex-col items-center gap-3 min-w-[180px]">
                    <span class="text-3xl">‚ù§Ô∏è</span>
                    <span class="text-xl font-bold text-green-500">¬£5 / $5 / ‚Ç¨5</span>
                    <span class="text-sm text-slate-400">Small Help</span>
                </a>
                <a href="https://buy.stripe.com/test_9AQg1x5619IpcP6dQR" target="_blank" rel="noopener" class="cyber-panel rounded-xl p-6 border-2 border-green-500 hover:bg-green-500/10 transition flex flex-col items-center gap-3 min-w-[180px]">
                    <span class="text-3xl">‚ö°</span>
                    <span class="text-xl font-bold text-green-500">¬£10 / $10 / ‚Ç¨10</span>
                    <span class="text-sm text-slate-400">Strong Support</span>
                </a>
                <a href="https://buy.stripe.com/test_3cs8z3bA9bUteR2cMN" target="_blank" rel="noopener" class="cyber-panel rounded-xl p-6 border-2 border-green-500 hover:bg-green-500/10 transition flex flex-col items-center gap-3 min-w-[180px]">
                    <span class="text-3xl">üõ°Ô∏è</span>
                    <span class="text-xl font-bold text-green-500">¬£25 / $25 / ‚Ç¨25</span>
                    <span class="text-sm text-slate-400">Guardian Tier</span>
                </a>
            </div>

            <p class="text-slate-400 mb-4">Or share this project:</p>
            <div class="flex flex-col sm:flex-row gap-3 justify-center">
                <a href="#" class="border-2 border-green-500 text-green-500 px-6 py-3 rounded-lg font-semibold hover:bg-green-500/10 transition flex items-center justify-center gap-2">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg>
                    Share on Twitter
                </a>
                <a href="#" class="border-2 border-green-500 text-green-500 px-6 py-3 rounded-lg font-semibold hover:bg-green-500/10 transition flex items-center justify-center gap-2">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
                    Share on Facebook
                </a>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section id="faq" class="py-20 px-6 bg-slate-900">
        <div class="max-w-3xl mx-auto">
            <h2 class="text-4xl md:text-5xl font-bold text-center mb-12">Frequently Asked Questions</h2>
            
            <div class="space-y-4">
                <details class="cyber-panel rounded-xl p-6 group">
                    <summary class="text-xl font-semibold cursor-pointer list-none flex items-center justify-between">
                        How does the AI detect scams?
                        <svg class="w-5 h-5 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </summary>
                    <p class="mt-4 text-slate-300 leading-relaxed">
                        TrustMyMsg uses advanced AI language models to analyze message patterns, urgency tactics, common scam phrases, 
                        suspicious requests for money or personal information, and inconsistencies in sender behavior. The AI has been 
                        trained on thousands of known scam examples to identify red flags that humans might miss.
                    </p>
                </details>

                <details class="cyber-panel rounded-xl p-6 group">
                    <summary class="text-xl font-semibold cursor-pointer list-none flex items-center justify-between">
                        Is my uploaded image stored?
                        <svg class="w-5 h-5 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </summary>
                    <p class="mt-4 text-slate-300 leading-relaxed">
                        No. We process your image in real-time and do not store it on our servers. Your privacy is paramount ‚Äî 
                        the image is analyzed, the results are returned to you, and then it's discarded. We only keep anonymous 
                        statistics (like "scans performed") to track our impact.
                    </p>
                </details>

                <details class="cyber-panel rounded-xl p-6 group">
                    <summary class="text-xl font-semibold cursor-pointer list-none flex items-center justify-between">
                        Who created TrustMyMsg?
                        <svg class="w-5 h-5 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </summary>
                    <p class="mt-4 text-slate-300 leading-relaxed">
                        TrustMyMsg was created by C.H., a developer who witnessed too many people fall victim to online scams. 
                        Frustrated by how easy it is for scammers to exploit vulnerable individuals, C.H. built this tool as a 
                        free public resource to help people verify suspicious messages before it's too late.
                    </p>
                </details>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-12 px-6 bg-slate-900 border-t border-blue-500/20">
        <div class="max-w-6xl mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <div class="flex flex-col items-center md:items-start gap-3">
                    <div class="flex items-center gap-2">
                        <svg class="w-6 h-6 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                        </svg>
                        <span class="text-xl font-bold">TrustMyMsg</span>
                    </div>
                    <p class="text-sm text-slate-400 text-center md:text-left">Protecting people from online scams.</p>
                </div>
                <div class="flex flex-col items-center md:items-end gap-4">
                    <p class="text-sm text-slate-400">¬© 2025 TrustMyMsg ‚Äî Created by C.H.</p>
                    <div class="flex gap-6">
                        <a href="#" class="text-sm text-slate-400 hover:text-green-500 transition">Terms</a>
                        <a href="#" class="text-sm text-slate-400 hover:text-green-500 transition">Privacy</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Scanner functionality
        const fileInput = document.getElementById('fileInput');
        const uploadArea = document.getElementById('uploadArea');
        const uploadPrompt = document.getElementById('uploadPrompt');
        const previewArea = document.getElementById('previewArea');
        const previewImage = document.getElementById('previewImage');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const clearBtn = document.getElementById('clearBtn');
        const loadingState = document.getElementById('loadingState');
        const errorState = document.getElementById('errorState');
        const errorMessage = document.getElementById('errorMessage');
        const resultsArea = document.getElementById('resultsArea');

        let currentImageBase64 = null;

        // File input handler
        fileInput.addEventListener('change', handleFileSelect);

        // Drag and drop
        uploadArea.addEventListener('click', () => {
            if (uploadPrompt.classList.contains('hidden')) return;
            fileInput.click();
        });

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('border-green-500');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('border-green-500');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('border-green-500');
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith('image/')) {
                handleFile(file);
            }
        });

        function handleFileSelect(e) {
            const file = e.target.files[0];
            if (file && file.type.startsWith('image/')) {
                handleFile(file);
            }
        }

        function handleFile(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                currentImageBase64 = e.target.result;
                previewImage.src = currentImageBase64;
                uploadPrompt.classList.add('hidden');
                previewArea.classList.remove('hidden');
                hideError();
                hideResults();
            };
            reader.readAsDataURL(file);
        }

        clearBtn.addEventListener('click', () => {
            fileInput.value = '';
            currentImageBase64 = null;
            previewArea.classList.add('hidden');
            uploadPrompt.classList.remove('hidden');
            hideError();
            hideResults();
        });

        analyzeBtn.addEventListener('click', analyzeImage);

        async function analyzeImage() {
            if (!currentImageBase64) {
                showError('Please select an image first');
                return;
            }

            hideError();
            hideResults();
            showLoading();

            try {
                const response = await fetch('https://odd-rain-b411.c44herbert.workers.dev/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        imageBase64: currentImageBase64
                    })
                });

                if (!response.ok) {
                    throw new Error(`Analysis failed: ${response.statusText}`);
                }

                const data = await response.json();
                
                // Extract result from OpenAI response structure
                let result;
                if (data.choices && data.choices[0] && data.choices[0].message) {
                    // Parse the JSON from the message content
                    const content = data.choices[0].message.content.trim();
                    let jsonContent = content;
                    
                    // Remove markdown code blocks if present
                    if (content.startsWith('```json')) {
                        jsonContent = content.split('```json')[1].split('```')[0].trim();
                    } else if (content.startsWith('```')) {
                        jsonContent = content.split('```')[1].split('```')[0].trim();
                    }
                    
                    result = JSON.parse(jsonContent);
                } else {
                    result = data;
                }

                hideLoading();
                displayResults(result);
            } catch (error) {
                hideLoading();
                showError(error.message || 'Analysis failed. Please try again.');
                console.error('Analysis error:', error);
            }
        }

        function calculateRiskScore(analysis) {
            let score = 0;
            if (analysis.moneyRequest) score += 40;
            if (analysis.loveBombing) score += 20;
            if (analysis.urgency) score += 15;
            if (analysis.avoidance) score += 15;
            score += (analysis.inconsistencies?.length || 0) * 10;
            score += (analysis.commonPhrasesCount || 0) * 12;
            return Math.min(score, 100);
        }

        function getRiskLevel(score) {
            if (score <= 30) return { level: 'SAFE', color: '#10B981', icon: 'check' };
            if (score <= 70) return { level: 'CAUTION', color: '#F59E0B', icon: 'warning' };
            return { level: 'DANGER', color: '#EF4444', icon: 'error' };
        }

        function displayResults(analysis) {
            const score = calculateRiskScore(analysis);
            const riskInfo = getRiskLevel(score);

            // Update risk card
            const riskCard = document.getElementById('riskCard');
            const riskScore = document.getElementById('riskScore');
            const riskLevel = document.getElementById('riskLevel');
            const riskIcon = document.getElementById('riskIcon');

            riskScore.textContent = score;
            riskScore.style.color = riskInfo.color;
            riskLevel.textContent = riskInfo.level;
            riskLevel.style.color = riskInfo.color;
            riskCard.style.borderColor = riskInfo.color;
            riskCard.style.backgroundColor = `${riskInfo.color}15`;

            // Update icon
            if (riskInfo.icon === 'check') {
                riskIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>';
                riskIcon.style.color = riskInfo.color;
            } else if (riskInfo.icon === 'warning') {
                riskIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>';
                riskIcon.style.color = riskInfo.color;
            } else {
                riskIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path>';
                riskIcon.style.color = riskInfo.color;
            }

            // Display red flags
            const redFlagsList = document.getElementById('redFlagsList');
            if (analysis.redFlags && analysis.redFlags.length > 0) {
                redFlagsList.innerHTML = analysis.redFlags.map((flag, index) => `
                    <div class="flex items-start gap-3 p-4 rounded mb-2" style="background: ${index % 2 === 0 ? 'rgba(239, 68, 68, 0.12)' : 'rgba(239, 68, 68, 0.08)'}; border-left: 3px solid #EF4444;">
                        <span class="text-red-500 text-xl">‚Ä¢</span>
                        <span class="text-red-400">${flag}</span>
                    </div>
                `).join('');
            } else {
                redFlagsList.innerHTML = '<p class="text-green-500 p-4 rounded" style="background: rgba(16, 185, 129, 0.1);">‚úì No major red flags detected</p>';
            }

            // Display analysis
            document.getElementById('explanationText').textContent = analysis.explanation || 'No explanation provided.';
            document.getElementById('recommendationText').textContent = analysis.recommendation || 'No recommendation provided.';
            document.getElementById('recommendationTitle').style.color = riskInfo.color;
            document.getElementById('analysisCard').style.borderLeftColor = riskInfo.color;
            document.getElementById('analysisCard').style.borderLeftWidth = '4px';

            resultsArea.classList.remove('hidden');
        }

        function showLoading() {
            loadingState.classList.remove('hidden');
            analyzeBtn.disabled = true;
            analyzeBtn.style.opacity = '0.5';
        }

        function hideLoading() {
            loadingState.classList.add('hidden');
            analyzeBtn.disabled = false;
            analyzeBtn.style.opacity = '1';
        }

        function showError(message) {
            errorMessage.textContent = message;
            errorState.classList.remove('hidden');
        }

        function hideError() {
            errorState.classList.add('hidden');
        }

        function hideResults() {
            resultsArea.classList.add('hidden');
        }
    </script>
</body>
</html>